<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>添加题目</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div th:replace="~{fragments/navbar :: navbar}"></div>
    
    <div class="container mt-4 mb-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h2 class="mb-0"><i class="bi bi-plus-circle"></i> 添加新题目</h2>
                    </div>
                    <div class="card-body">
                        <form method="post" th:action="@{/questions/add}" th:object="${question}">
                            <div class="mb-3">
                                <label class="form-label fw-bold">题目内容 <span class="text-danger">*</span></label>
                                <textarea name="content" class="form-control" rows="4" required 
                                          placeholder="请输入题目内容..."></textarea>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-bold">题型 <span class="text-danger">*</span></label>
                                    <select name="type" class="form-select" id="questionType" onchange="toggleOptions()">
                                        <option value="SINGLE">单选题</option>
                                        <option value="MULTIPLE">多选题</option>
                                        <option value="FILL">填空题</option>
                                        <option value="SUBJECTIVE">主观题</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-bold">难度 <span class="text-danger">*</span></label>
                                    <select name="difficulty" class="form-select">
                                        <option value="1" selected>简单</option>
                                        <option value="2">中等</option>
                                        <option value="3">较难</option>
                                        <option value="4">困难</option>
                                        <option value="5">极难</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3" id="optionsField">
                                <label class="form-label fw-bold">选项</label>
                                <textarea name="options" id="optionsInput" class="form-control" rows="3" 
                                          placeholder='格式：["A.选项1","B.选项2","C.选项3","D.选项4"]'></textarea>
                                <small class="text-muted">
                                    <i class="bi bi-info-circle"></i> 选择题需要填写选项，格式为JSON数组
                                </small>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label fw-bold">答案 <span class="text-danger">*</span></label>
                                <input name="answer" class="form-control" required 
                                       placeholder="单选题：A  多选题：A,B  填空题：答案内容" />
                                <small class="text-muted">
                                    <i class="bi bi-info-circle"></i> 单选题填写选项字母，多选题用逗号分隔，填空题和主观题填写答案内容
                                </small>
                            </div>
                            
                            <div class="d-flex justify-content-between">
                                <a href="/questions" class="btn btn-secondary">
                                    <i class="bi bi-arrow-left"></i> 取消
                                </a>
                                <button type="submit" class="btn btn-success">
                                    <i class="bi bi-check-circle"></i> 保存题目
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="bg-dark text-white text-center py-3 mt-5">
        <div class="container">
            <p class="mb-0">© 2025 在线考试系统</p>
        </div>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function toggleOptions() {
            const type = document.getElementById('questionType').value;
            const optionsField = document.getElementById('optionsField');
            const optionsInput = document.getElementById('optionsInput');
            
            // 只有选择题需要显示选项字段
            if (type === 'SINGLE' || type === 'MULTIPLE') {
                optionsField.style.display = 'block';
                optionsInput.removeAttribute('disabled');
            } else {
                optionsField.style.display = 'none';
                // 填空题和主观题时，禁用options字段，这样就不会提交
                optionsInput.setAttribute('disabled', 'disabled');
                optionsInput.value = '';
            }
        }
        
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            toggleOptions();
        });
    </script>
</body>
</html>